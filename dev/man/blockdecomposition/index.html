<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Setup decomposition using BlockDecomposition · Coluna.jl</title><meta name="title" content="Setup decomposition using BlockDecomposition · Coluna.jl"/><meta property="og:title" content="Setup decomposition using BlockDecomposition · Coluna.jl"/><meta property="twitter:title" content="Setup decomposition using BlockDecomposition · Coluna.jl"/><meta name="description" content="Documentation for Coluna.jl."/><meta property="og:description" content="Documentation for Coluna.jl."/><meta property="twitter:description" content="Documentation for Coluna.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.048/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><script src="../../assets/js/init.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Coluna.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs (Ctrl + /)"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Tutorials</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Getting Started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../start/start/">Column generation</a></li><li><a class="tocitem" href="../../start/cuts/">Cut Generation</a></li><li><a class="tocitem" href="../../start/pricing/">Pricing callback</a></li><li><a class="tocitem" href="../../start/identical_sp/">Identical subproblems</a></li><li><a class="tocitem" href="../../start/custom_data/">Custom data</a></li><li><a class="tocitem" href="../../start/initial_columns/">Initial columns callback</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Advanced tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../start/advanced_demo/">Column Generation and Benders on Location Routing</a></li><li><a class="tocitem" href="../../start/other_pbs/">Other classic problems</a></li></ul></li></ul></li><li><span class="tocitem">Manual</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox" checked/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Decomposition</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../decomposition/">Decomposition paradigms</a></li><li class="is-active"><a class="tocitem" href>Setup decomposition using BlockDecomposition</a><ul class="internal"><li><a class="tocitem" href="#Errors-and-warnings"><span>Errors and warnings</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../config/">Configuration</a></li><li><a class="tocitem" href="../algorithm/">Built-in algorithms</a></li><li><a class="tocitem" href="../callbacks/">User-defined Callbacks</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../api/algos/">Algorithms</a></li><li><a class="tocitem" href="../../api/benders/">Benders</a></li><li><a class="tocitem" href="../../api/branching/">Branching</a></li><li><a class="tocitem" href="../../api/colgen/">ColGen</a></li><li><a class="tocitem" href="../../api/treesearch/">TreeSearch</a></li><li><a class="tocitem" href="../../api/storage/">Storage</a></li></ul></li><li><a class="tocitem" href="../../dynamic_sparse_arrays/">Dynamic Sparse Arrays</a></li><li><a class="tocitem" href="../../qa/">Q&amp;A</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><div class="docs-left"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li><a class="is-disabled">Decomposition</a></li><li class="is-active"><a href>Setup decomposition using BlockDecomposition</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Setup decomposition using BlockDecomposition</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/atoptima/Coluna.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/atoptima/Coluna.jl/blob/master/docs/src/man/blockdecomposition.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Setup-decomposition-with-BlockDecomposition"><a class="docs-heading-anchor" href="#Setup-decomposition-with-BlockDecomposition">Setup decomposition with BlockDecomposition</a><a id="Setup-decomposition-with-BlockDecomposition-1"></a><a class="docs-heading-anchor-permalink" href="#Setup-decomposition-with-BlockDecomposition" title="Permalink"></a></h1><p>BlockDecomposition allows the user to perform two types of decomposition using <a href="#BlockDecomposition.@dantzig_wolfe_decomposition"><code>BlockDecomposition.@dantzig_wolfe_decomposition</code></a> and <a href="#BlockDecomposition.@benders_decomposition"><code>BlockDecomposition.@benders_decomposition</code></a>.</p><p>For both decompositions, the index-set of the subproblems is declared through an <a href="#BlockDecomposition.@axis"><code>BlockDecomposition.@axis</code></a>.  It returns an array. Each value of the array is a subproblem index wrapped into a <code>BlockDecomposition.AxisId</code>. Each time BlockDecomposition finds an <code>AxisId</code> in the indices of a variable and a constraint, it knows to which subproblem the variable or the constraint belongs.</p><p>The macro creates a decomposition tree where the root is the master and the depth is the number of nested decompositions. A classic Dantzig-Wolfe or Benders decomposition produces a decomposition tree of depth 1. At the moment, nested decomposition is not supported.</p><p>You can get the subproblem membership of all variables and constraints using the method <a href="#BlockDecomposition.annotation"><code>BlockDecomposition.annotation</code></a>.</p><p>BlockDecomposition does not change the JuMP model. It decorates the model with additional information. All this information is stored in the <code>ext</code> field of the JuMP model.</p><h2 id="Errors-and-warnings"><a class="docs-heading-anchor" href="#Errors-and-warnings">Errors and warnings</a><a id="Errors-and-warnings-1"></a><a class="docs-heading-anchor-permalink" href="#Errors-and-warnings" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BlockDecomposition.MasterVarInDwSp" href="#BlockDecomposition.MasterVarInDwSp"><code>BlockDecomposition.MasterVarInDwSp</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Error thrown when a master variable is in a constraint that belongs to a Dantzig-Wolfe subproblem.</p><p>You can retrieve the JuMP variable and the JuMP constraint where the error occurs:</p><pre><code class="language-julia hljs">error.variable
error.constraint</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BlockDecomposition.VarsOfSameDwSpInMaster" href="#BlockDecomposition.VarsOfSameDwSpInMaster"><code>BlockDecomposition.VarsOfSameDwSpInMaster</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Warning when a master constraint involves variables that belong to the same Dantzig-Wolfe subproblem. It means you can move the constraint in a subproblem.</p></div></section></article><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BlockDecomposition.BlockModel" href="#BlockDecomposition.BlockModel"><code>BlockDecomposition.BlockModel</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">BlockModel(optimizer [, direct_model = false])</code></pre><p>Return a JuMP model which BlockDecomposition will decompose using instructions given by the user.</p><p>If you define <code>direct_model = true</code>, the method creates the model with <code>JuMP.direct_model</code>, otherwise it uses <code>JuMP.Model</code>.</p></div></section></article><p>These are the methods to decompose a JuMP model :</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BlockDecomposition.@axis" href="#BlockDecomposition.@axis"><code>BlockDecomposition.@axis</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@axis(name, collection)</code></pre><p>Declare <code>collection</code> as an index-set of subproblems.  You can access the axis using the variable <code>name</code>.</p><p><strong>Examples</strong></p><p>Consider a formulation that has a decomposition which gives raise to 5 subproblems. Let {1,2,3,4,5} be the index-set of the subproblems.</p><p>To perform this decomposition with BlockDecomposition, we must declare an axis that contains the index-set of the subproblems :</p><pre><code class="language-julia-repl hljs">julia&gt; L = 1:5
1:5

julia&gt; @axis(K, L)
BlockDecomposition.Axis{:K, Int64}(:K, BlockDecomposition.AxisId{:K, Int64}[1, 2, 3, 4, 5])

julia&gt; K[1]
1

julia&gt; typeof(K[1])
BlockDecomposition.AxisId{:K, Int64}</code></pre><p>The elements of the axis are <code>AxisId</code>. You must use <code>AxisId</code> in the indices of the variables and the constraints that you declare otherwise BlockDecomposition assign them to the master problem.</p><pre><code class="nohighlight hljs">@variable(model, x[l in L]) # x[l] belongs to the master for any l ∈ L
@variable(model, y[k in K]) # y[k], k ∈ K, belongs to subproblem k (because K is an axis)</code></pre></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BlockDecomposition.@benders_decomposition" href="#BlockDecomposition.@benders_decomposition"><code>BlockDecomposition.@benders_decomposition</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@benders_decomposition(model, name, axis)</code></pre><p>Register a Benders decomposition on the JuMP model <code>model</code> where the index-set of the subproblems is defined by the axis <code>axis</code>.</p><p>Create a variable <code>name</code> from which the user can access decomposition tree.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BlockDecomposition.@dantzig_wolfe_decomposition" href="#BlockDecomposition.@dantzig_wolfe_decomposition"><code>BlockDecomposition.@dantzig_wolfe_decomposition</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@dantzig_wolfe_decomposition(model, name, axis)</code></pre><p>Register a Dantzig-Wolfe decomposition on the JuMP model <code>model</code> where the index-set of the subproblems is defined by the axis <code>axis</code>.</p><p>Create a variable <code>name</code> from which the user can access the decomposition tree.</p></div></section></article><p>These are the methods to set additional information to the decomposition (multiplicity and optimizers) :</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BlockDecomposition.getmaster" href="#BlockDecomposition.getmaster"><code>BlockDecomposition.getmaster</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">getmaster(node) -&gt; MasterForm</code></pre><p>Return an object that wraps the annotation that describes the master formulation of a decomposition stored at the <code>node</code> of the decomposition tree.</p><p>This method is not defined if the node is a leaf of the decomposition tree.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BlockDecomposition.getsubproblems" href="#BlockDecomposition.getsubproblems"><code>BlockDecomposition.getsubproblems</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">getsubproblems(node) -&gt; Vector{SubproblemForm}</code></pre><p>Return a vector of objects that wrap the annotations that describe subproblem formulations of a decomposition stored at <code>node</code> of the decomposition tree.</p><p>This method is not defined if the node is a leaf of the decomposition tree.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BlockDecomposition.specify!" href="#BlockDecomposition.specify!"><code>BlockDecomposition.specify!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">specify!(
    subproblem, 
    lower_multiplicity = 1,
    upper_multiplicity = 1,
    solver = nothing
)</code></pre><p>Method that allows the user to specify additional property of the subproblems.</p><p>The multiplicity of <code>subproblem</code> is the number of times that the same independant block shaped by the subproblem in the coefficient matrix appears in the model. It is equivalent to the number of solutions to the subproblem that can appear in the solution  of the original problem.</p><p>The solver of the subproblem is the way the subproblem will be optimized. It can be either a function (pricing callback), an optimizer of MathOptInterface  (e.g. <code>Gurobi.Optimizer</code>, <code>CPLEX.Optimizer</code>, <code>Glpk.Optimizer</code>... with attributes),  or <code>nothing</code>. In the latter case, the solver will use a default optimizer that  should be defined in the parameters of the main solver.</p><p><strong>Advanced usage</strong> :  The user can use several solvers to optimize a subproblem : </p><pre><code class="nohighlight hljs">specify!(subproblem, solver = [Gurobi.Optimizer, my_callback, my_second_callback])</code></pre><p>Coluna always uses the first solver by default. Be cautious because changes are always buffered to all solvers. So you may degrade performances if you use a lot of solvers.</p></div></section></article><p>This method helps you to check your decomposition :</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BlockDecomposition.annotation" href="#BlockDecomposition.annotation"><code>BlockDecomposition.annotation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">annotation(node)</code></pre><p>Return the annotation that describes the master/subproblem of a given node of the decomposition tree.</p><pre><code class="nohighlight hljs">annotation(model, variable)
annotation(model, constraint)</code></pre><p>Return the subproblem to which a variable or a constraint belongs.</p></div></section></article><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../decomposition/">« Decomposition paradigms</a><a class="docs-footer-nextpage" href="../config/">Configuration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.28.0-DEV on <span class="colophon-date" title="Tuesday 12 September 2023 14:19">Tuesday 12 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
